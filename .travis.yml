language: c++

cache:
  ccache: true
  pip: true

addons:
  apt:
    update: true
    packages:
      - clang
      - clang-format
      - llvm
      - lcov
      - ruby
      - gcc-12
      - g++-12

jobs:
  include:
    - os: linux
      dist: jammy
      env:
        - RUN_TYPE=static-analysis
        - MATRIX_EVAL="CC=clang && CXX=clang++"
    - os: linux
      dist: jammy
      env:
        - RUN_TYPE=coverage
        - MATRIX_EVAL="CC=clang && CXX=clang++"
    - os: linux
      dist: jammy
      env:
        - RUN_TYPE=test
        - MATRIX_EVAL="CC=gcc-12 && CXX=g++-12"
    - os: linux
      dist: jammy
      env:
        - RUN_TYPE=test
        - MATRIX_EVAL="CC=clang && CXX=clang++"

before_install:
  - eval "${MATRIX_EVAL}"

install:
  - tools/ci/install.sh

script:
  - tools/ci/build.sh && tools/ci/test.sh

after_success:
  - tools/ci/after_success.sh

notifications:
  slack:
    secure: ErBI1W7SR9lK/ZFfy62NONogHMaq2q+gxICi0OP5kP4wm+wFftrNnH1yJaqwbhzyKW+nwBCyq4xO3s9D0AC4LHI5JczzsW6KDgf0/rVlNTaRHTn4xHvnjsKSTTUsisM1umy0h9S7NcnGsmqKtkgeSXg8lhcYyN3Dich+zqVPQtrtX5ecjaNe75/tz/2Addj2BZ3yb4tLv/uyzqhLCDvFoO6vYrFwYf9puozKCiN+8ZuT/SLV+4hcgqzx1C82hMYbzrr+cxHbEIjG+OZzF32mTZ2JxgNxuB25hIi23nywWm9HO2vQavD3i97+WVyZkG/44aItytx6Cr1fvyadVVEvnBRa+k04+gDFrBVNcccRZiREc21SpJOaICYrOPQH1Xpi0UBnKu28l12kmL95QgZD70h3sThjzXNXknUYg1RFZeYoatJCbl32nkBlCvajrVJCbwIIoH7xJ5gkzN46dIOTdwthIz9sagNEQhcLuErulOFts4SYZUKIeHLhQH2LUB6mRUsNswyYffGy2JGAxMrwhse5tROI4c+/59fsx3dUNuQGSwJViM7XkDQhFGR5Ybn3gEPHhxI6eb798bcCfu/ac4r4vBFg/P/O7FOfYcO2IKfa+Fxj/LS10vwUO2+LnlQ4nAcuwZ8+NgQ1QL+uGFrcq8PbnxO0MqYcpa1Dehc6hqw=
    on_success: never
